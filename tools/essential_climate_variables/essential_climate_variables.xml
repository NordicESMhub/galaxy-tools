<tool id="cds" name="Copernicus Essential" version="0.1.4">
    <description>Climate Variables</description>
    <requirements>
        <requirement type="package" version="3">python</requirement>
        <requirement type="package" version="0.1.4">cdsapi</requirement>
        <requirement type="package" version="1.9.6">cdo</requirement>
    </requirements>
    <command detect_errors="exit_code"><![CDATA[
       python3 '$__tool_directory__/ecv_retrieve.py'
            'ecv-for-climate-change' '$variable'
            --year '$year'
        #if str($time_aggregation.selector) == 'monthly'
            --month '$time_aggregation.month'
        #else
            --month '01'
        #end if
           --time_aggregation '$time_aggregation.selector'
           --product_type '$product_type'
           --format 'tgz' --output 'tmp.tgz'
           --verbose                                       &&
           tar zxvf tmp.tgz                                &&
           cat *.grib > tmp.grib                           &&
           cdo -f nc -t ecmwf copy tmp.grib tmp.nc                   &&
           rm -rf *.grib
    ]]></command>
    <inputs>
        <param name="variable" type="select" multiple="true" label="Variable(s)">
                <option value="surface_air_temperature" selected="true">Surface air temperature</option>
                <option value="surface_air_relative_humidity" selected="true">Surface air relative humidity</option>
                <option value="0_7cm_volumetric_soil_moisture" selected="true">0-7cm volumetric soil moisture</option>
                <option value="precipitation" selected="true">Precipitation</option>
                <option value="sea_ice" selected="true">Sea-ice</option>
        </param>
          <param name="product_type" type="select" label="Select type of data">
            <option value="climatology" selected="true">Climatology</option>
            <option value="anomaly">Anomaly</option>
          </param>
        <conditional name="time_aggregation">
          <param name="selector" type="select" label="Time aggregation">
              <option value="12_month" selected="true">yearly</option>
             <option value="1_month">monthly</option>
          </param>
          <when value="1_month">
            <param name="month" type="select" multiple="true" label="Select month(s)">
              <option value="01" selected="true">January</option>
              <option value="02" selected="true">February</option>
              <option value="03" selected="true">March</option>
              <option value="04" selected="true">April</option>
              <option value="05" selected="true">May</option>
              <option value="06" selected="true">June</option>
              <option value="07" selected="true">July</option>
              <option value="08" selected="true">August</option>
              <option value="09" selected="true">September</option>
              <option value="10" selected="true">October</option>
              <option value="11" selected="true">November</option>
              <option value="12" selected="true">December</option>
            </param>
          </when>
         </conditional>

          <param name="year" type="select" multiple="true"  label="Select year(s)">
             <option value="1979">1979</option>
             <option value="1980">1980</option>
             <option value="1981">1981</option>
             <option value="1982">1982</option>
             <option value="1983">1983</option>
             <option value="1984">1984</option>
             <option value="1985">1985</option>
             <option value="1986">1986</option>
             <option value="1987">1987</option>
             <option value="1988">1988</option>
             <option value="1989">1989</option>
             <option value="1990">1990</option>
             <option value="1991">1991</option>
             <option value="1992">1992</option>
             <option value="1993">1993</option>
             <option value="1994">1994</option>
             <option value="1995">1995</option>
             <option value="1996">1996</option>
             <option value="1997">1997</option>
             <option value="1998">1998</option>
             <option value="1999">1999</option>
             <option value="2000">2000</option>
             <option value="2001">2001</option>
             <option value="2002">2002</option>
             <option value="2003">2003</option>
             <option value="2004">2004</option>
             <option value="2005">2005</option>
             <option value="2006">2006</option>
             <option value="2007">2007</option>
             <option value="2008">2008</option>
             <option value="2009">2009</option>
             <option value="2010">2010</option>
             <option value="2011">2011</option>
             <option value="2012">2012</option>
             <option value="2013">2013</option>
             <option value="2014">2014</option>
             <option value="2015">2015</option>
             <option value="2016">2016</option>
             <option value="2017">2017</option>
             <option value="2018">2018</option>
             <option value="2019" selected="true">2019</option>
          </param>
    </inputs>
    <outputs>
        <data name="ofilename" format="netcdf" from_work_dir="tmp.nc"/>
    </outputs>
    <help><![CDATA[

**Copernicus Essential Climate Variables**
===========================================

This tool allows to retrieve Essential Climate Variables from Copernicus..


.. class:: infomark

        TODO: Fill in help.

**What it does**
----------------

TODO

**Usage**

::

  usage:


Positional arguments:
~~~~~~~~~~~~~~~~~~~~~

TO DO

Optional arguments:
~~~~~~~~~~~~~~~~~~~~~

TODO
  --output OUTPUT  output filename to store resulting image (png format)
  -v, --verbose    switch on verbose mode


    ]]></help>
    <citations>
    </citations>
</tool>
